<html>
<head>
  <title>八、XML解析技术（JAXP的SAX解析）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/302292 (zh-CN); Windows/10.0.10586 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="518"/>
<h1>八、XML解析技术（JAXP的SAX解析）</h1>

<div>
<span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
如果XML很大，dom容易溢出。这里用SAX。
<div>创建出SAX解析器后，就会解析指定XML文档。</div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt; background:#d4d4d4">org.xml.sax.* 包</span></font></div><div>1、SAX原理<br/><div><img src="八、XML解析技术（JAXP的SAX解析）_files/Image.png" type="image/png" height="323" style="cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;cursor: default;" width="481"/><br/><div>解析器-&gt;读取器</div></div></div><div><br/></div><div align="left"> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//1.创建解析工厂</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">SAXParserFactory</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">factory</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">= SAXParserFactory.</span><span style="font-size:10pt"><i>newInstance</i></span><span style="font-size:10pt">();</span></font></div><div align="left"> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//2.得到解析器</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">SAXParser</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">sp</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">factory</span></font><font face="Courier New" size="2"><span style="font-size:10pt">.newSAXParser();</span></font></div><div align="left"><font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//3.得到读取器</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">XMLReader</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">reader</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">=</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">sp</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">.getXMLReader();</span></font></div><div align="left"><font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//4.设置内容处理器</span></font></div><div align="left"><font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">reader</span></font><font face="Courier New" size="2"><span style="font-size:10pt">.setContentHandler(</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>new</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">TagValueHandle());</span></font></div><div align="left"><font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//5.读取</span><span style="font-size:10pt"><u>xml</u></span><span style="font-size:10pt">文档内容</span></font></div><div align="left"> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">reader</span></font><font face="Courier New" size="2"><span style="font-size:10pt">.parse(</span></font><font color="#2A00FF" face="Courier New" size="2"><span style="font-size:10pt">&quot;src/book.xml&quot;</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">);</span></font></div><div><br/></div><div>注：setContentHandler 的参数是一个<span style="background-color: rgb(212, 212, 212); font-size: 10pt; font-family: &apos;Courier New&apos;;">ContentHandler接口类</span></div><div><br/></div><div align="left"><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>private</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">String</span></font> <font color="#0000C0" face="Courier New" size="2"><span style="font-size:10pt">CurrencyTag</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">;</span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//记住当前解析什么标签</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#646464" face="Courier New" size="2"><span style="font-size:10pt">@Override</span></font></div><div align="left"><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">startElement(String</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">uri</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, String</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">localName</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, String</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">qName</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font><font face="Courier New" size="2"><span style="font-size:10pt">Attributes</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">atts</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SAXException {</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//</span></font> <font color="#7F9FBF" face="Courier New" size="2"><span style="font-size:10pt"><b>TODO</b></span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">Auto-generated method stub</span></font></div><div align="left"><span style="font-size: 10pt; font-family: &apos;Courier New&apos;;">     }</span></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#646464" face="Courier New" size="2"><span style="font-size:10pt">@Override</span></font></div><div align="left"><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">endElement(String</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">uri</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, String</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">localName</span></font><font face="Courier New" size="2"><span style="font-size:10pt">, String</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">qName</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">)</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SAXException {</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//</span></font> <font color="#7F9FBF" face="Courier New" size="2"><span style="font-size:10pt"><b>TODO</b></span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">Auto-generated method stub</span></font><span style="font-family: &apos;Courier New&apos;; font-size: 10pt;">      </span></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      </span></font> <font color="#646464" face="Courier New" size="2"><span style="font-size:10pt">@Override</span></font></div><div align="left"><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>public</b></span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>void</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">characters(</span></font><font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>char</b></span></font><font face="Courier New" size="2"><span style="font-size:10pt">[]</span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">ch</span></font><font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">start</span></font> <font face="Courier New" size="2"><span style="font-size:10pt">,</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>int</b></span></font> <font color="#6A3E3E" face="Courier New" size="2"><span style="font-size:10pt">length</span></font><font face="Courier New" size="2"><span style="font-size:10pt">)</span></font> <font color="#7F0055" face="Courier New" size="2"><span style="font-size:10pt"><b>throws</b></span></font> <font face="Courier New" size="2"><span style="font-size:10pt">SAXException {</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">            </span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">//</span></font> <font color="#7F9FBF" face="Courier New" size="2"><span style="font-size:10pt"><b>TODO</b></span></font> <font color="#3F7F5F" face="Courier New" size="2"><span style="font-size:10pt">Auto-generated method stub</span></font></div><div align="left"><font face="Courier New" size="2"><span style="font-size:10pt">      }</span></font></div><div><br/></div><div>这是个循环被调用的函数，一般设标签。</div><div>但用完标签之后要设为null；否则有异常。下面节课说为什么有异常</div><div>这主要是#text 空格，换行的原因。要用一次清一次</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 